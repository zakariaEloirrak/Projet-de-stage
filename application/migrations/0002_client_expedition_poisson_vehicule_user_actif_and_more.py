# Generated by Django 5.2 on 2025-07-24 11:37

import datetime
import django.db.models.deletion
import django.utils.timezone
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('application', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='CLIENT',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code_client', models.CharField(blank=True, max_length=20, null=True, unique=True)),
                ('nom_societe', models.CharField(max_length=100)),
                ('pays', models.CharField(blank=True, default='Morocco', max_length=100, null=True)),
                ('email', models.EmailField(max_length=254)),
                ('telephone', models.CharField(blank=True, max_length=15, null=True)),
                ('adresse', models.CharField(blank=True, max_length=255, null=True)),
                ('role', models.CharField(choices=[('CLIENT', 'ACHETEUR'), ('FOURNISSEUR', 'FOURNISSEUR')], default='CLIENT', max_length=20)),
                ('numero_registre_commerce', models.CharField(blank=True, max_length=50, null=True)),
                ('numero_ice', models.CharField(blank=True, max_length=20, null=True)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='Expedition',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_expedition', models.CharField(max_length=50, unique=True, verbose_name="Numéro d'expédition")),
                ('destinataire', models.CharField(max_length=200, verbose_name='Destinataire')),
                ('adresse', models.TextField(verbose_name='Adresse de livraison')),
                ('transporteur', models.CharField(max_length=100, verbose_name='Transporteur')),
                ('date_expedition', models.DateField(default=datetime.date.today, verbose_name="Date d'expédition")),
                ('statut', models.CharField(choices=[('En préparation', 'En préparation'), ('Expédié', 'Expédié'), ('En transit', 'En transit'), ('En cours de livraison', 'En cours de livraison'), ('Livré', 'Livré'), ('Retardé', 'Retardé'), ('Problème', 'Problème')], default='En préparation', max_length=50, verbose_name='Statut')),
                ('date_livraison_prevue', models.DateTimeField(blank=True, null=True, verbose_name='Date de livraison prévue')),
                ('date_livraison_reelle', models.DateTimeField(blank=True, null=True, verbose_name='Date de livraison réelle')),
                ('notes', models.TextField(blank=True, verbose_name='Notes')),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_modification', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Expédition',
                'verbose_name_plural': 'Expéditions',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='POISSON',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code_produit', models.CharField(blank=True, max_length=20, null=True, unique=True)),
                ('type', models.CharField(max_length=100)),
                ('prix', models.DecimalField(decimal_places=2, max_digits=10)),
                ('quantite_stock', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('unite_mesure', models.CharField(default='KG', max_length=10)),
                ('seuil_alerte', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='Vehicule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100)),
                ('conducteur', models.CharField(blank=True, max_length=100, null=True)),
                ('capacite', models.PositiveIntegerField(help_text='Capacité en KG')),
                ('immatriculation', models.CharField(max_length=15, unique=True)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
            ],
        ),
        migrations.AddField(
            model_name='user',
            name='actif',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='user',
            name='date_creation',
            field=models.DateTimeField(default=django.utils.timezone.now),
        ),
        migrations.AddField(
            model_name='user',
            name='date_modification',
            field=models.DateTimeField(auto_now=True),
        ),
        migrations.AlterField(
            model_name='user',
            name='password',
            field=models.CharField(max_length=128),
        ),
        migrations.AlterField(
            model_name='user',
            name='role',
            field=models.CharField(choices=[('ADMIN', 'Administrator'), ('USER', 'Utilisateur'), ('COMPTABLE', 'Comptable'), ('GESTIONNAIRE', 'Gestionnaire')], default='USER', max_length=15),
        ),
        migrations.AlterField(
            model_name='user',
            name='user_email',
            field=models.EmailField(max_length=254, unique=True),
        ),
        migrations.AlterField(
            model_name='user',
            name='username',
            field=models.CharField(max_length=100, unique=True),
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('CREATE', 'Création'), ('UPDATE', 'Modification'), ('DELETE', 'Suppression'), ('VIEW', 'Consultation'), ('EXPORT', 'Export'), ('IMPORT', 'Import')], max_length=10)),
                ('model_name', models.CharField(max_length=50)),
                ('object_id', models.PositiveIntegerField()),
                ('object_repr', models.CharField(max_length=200)),
                ('date_action', models.DateTimeField(default=django.utils.timezone.now)),
                ('adresse_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('details', models.JSONField(blank=True, default=dict)),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
            ],
            options={
                'ordering': ['-date_action'],
            },
        ),
        migrations.CreateModel(
            name='Commande',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_commande', models.CharField(blank=True, max_length=30, null=True, unique=True)),
                ('type_commande', models.CharField(choices=[('EXPORT', 'Export'), ('IMPORT', 'Import'), ('LOCAL', 'Local')], default='EXPORT', max_length=10)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_expedition', models.DateField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('BROUILLON', 'Brouillon'), ('CONFIRMEE', 'Confirmée'), ('PREPARATION', 'En préparation'), ('EXPEDIEE', 'Expédiée'), ('LIVREE', 'Livrée'), ('ANNULEE', 'Annulée')], default='BROUILLON', max_length=15)),
                ('incoterm', models.CharField(blank=True, choices=[('EXW', 'Ex Works'), ('FOB', 'Free On Board'), ('CIF', 'Cost Insurance Freight'), ('DDP', 'Delivered Duty Paid')], max_length=5, null=True)),
                ('commentaire', models.TextField(blank=True, null=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.client')),
                ('utilisateur_creation', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='commandes_creees', to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='Document',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fichier', models.FileField(upload_to='documents/')),
                ('nom_document', models.CharField(max_length=100)),
                ('type', models.CharField(choices=[('facture', 'Facture'), ('bon_livraison', 'Bon de Livraison'), ('bon_commande', 'Bon de Commande'), ('certificat_origine', "Certificat d'Origine"), ('licence_export', "Licence d'Export"), ('connaissement', 'Connaissement'), ('autre', 'Autre')], max_length=50)),
                ('numero_document', models.CharField(blank=True, max_length=50, null=True)),
                ('date_ajout', models.DateTimeField(default=django.utils.timezone.now)),
                ('envoye_agence', models.BooleanField(default=False)),
                ('date_envoi_agence', models.DateTimeField(blank=True, null=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.commande')),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='EtapeTransport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('mode_transport', models.CharField(choices=[('BATEAU', 'Bateau'), ('CAMION', 'Camion'), ('AVION', 'Avion')], max_length=10)),
                ('transporteur', models.CharField(choices=[('Transporteur A', 'Transporteur A'), ('Transporteur B', 'Transporteur B'), ('Transporteur C', 'Transporteur C')], default='Transporteur A', max_length=100)),
                ('date_depart', models.DateField()),
                ('num_conteneur', models.CharField(blank=True, max_length=50, null=True)),
                ('statut', models.CharField(choices=[('EN_ATTENTE', 'En attente'), ('EN_TRANSIT', 'En transit'), ('LIVREE', 'Livrée')], default='EN_ATTENTE', max_length=20)),
                ('FraisTransport', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('numero_suivi', models.CharField(blank=True, max_length=50, null=True)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='etapes_transport', to='application.commande')),
            ],
        ),
        migrations.CreateModel(
            name='Facture',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_facture', models.CharField(max_length=50, unique=True)),
                ('montant_ht', models.DecimalField(decimal_places=2, max_digits=10)),
                ('taux_tva', models.DecimalField(decimal_places=2, default=20, max_digits=5)),
                ('montant_tva', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('montant_ttc', models.DecimalField(decimal_places=2, max_digits=10)),
                ('date_emission', models.DateTimeField(default=django.utils.timezone.now)),
                ('date_echeance', models.DateTimeField()),
                ('mode_paiement', models.CharField(choices=[('carte_bancaire', 'Carte Bancaire'), ('virement', 'Virement'), ('cheque', 'Chèque'), ('especes', 'Espèces')], max_length=50)),
                ('statut', models.CharField(choices=[('brouillon', 'Brouillon'), ('emise', 'Émise'), ('envoyee', 'Envoyée'), ('payee', 'Payée'), ('annulee', 'Annulée')], default='brouillon', max_length=20)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.client')),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.commande')),
                ('utilisateur_creation', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='Comptabilite',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('montant_total', models.DecimalField(decimal_places=2, max_digits=10)),
                ('date_enregistrement', models.DateTimeField(default=django.utils.timezone.now)),
                ('export_comptable', models.BooleanField(default=False)),
                ('date_export_comptable', models.DateTimeField(blank=True, null=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.commande')),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
                ('facture', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='application.facture')),
            ],
            options={
                'verbose_name': 'Comptabilité',
                'verbose_name_plural': 'Comptabilités',
            },
        ),
        migrations.CreateModel(
            name='Historique',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(max_length=255)),
                ('date_action', models.DateTimeField(default=django.utils.timezone.now)),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='LigneCommande',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantite', models.DecimalField(decimal_places=2, max_digits=10)),
                ('prix_unitaire', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('total_ligne', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.commande')),
                ('poisson', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.poisson')),
            ],
        ),
        migrations.AddField(
            model_name='facture',
            name='ligne_commande',
            field=models.ManyToManyField(blank=True, to='application.lignecommande'),
        ),
        migrations.CreateModel(
            name='Livraison',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_livraison', models.CharField(blank=True, max_length=30, null=True, unique=True)),
                ('date_livraison', models.DateTimeField(default=django.utils.timezone.now)),
                ('adresse_livraison', models.CharField(max_length=255)),
                ('frais_livraison', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('statut', models.CharField(choices=[('en_attente', 'En attente'), ('en_cours', 'En cours'), ('terminee', 'Terminée'), ('annulee', 'Annulée')], default='en_attente', max_length=20)),
                ('chauffeur', models.CharField(blank=True, max_length=100, null=True)),
                ('signature_client', models.TextField(blank=True, null=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.commande')),
                ('vehicule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.vehicule')),
            ],
        ),
        migrations.AddField(
            model_name='facture',
            name='livraison',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='application.livraison'),
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('message', models.TextField()),
                ('date_notification', models.DateTimeField(default=django.utils.timezone.now)),
                ('lu', models.BooleanField(default=False)),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='MouvementStock',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_mouvement', models.CharField(choices=[('ENTREE', 'Entrée'), ('SORTIE', 'Sortie'), ('AJUSTEMENT', 'Ajustement'), ('RETOUR', 'Retour')], max_length=15)),
                ('quantite', models.DecimalField(decimal_places=2, max_digits=10)),
                ('date_mouvement', models.DateTimeField(default=django.utils.timezone.now)),
                ('motif', models.TextField(blank=True, null=True)),
                ('commande', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.commande')),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
                ('poisson', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.poisson')),
            ],
        ),
        migrations.CreateModel(
            name='Rapport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('titre', models.CharField(max_length=255)),
                ('contenu', models.TextField()),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('auteur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='application.user')),
            ],
        ),
        migrations.CreateModel(
            name='Tarif',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_tarif', models.CharField(choices=[('ACHAT', "Prix d'achat"), ('VENTE', 'Prix de vente'), ('TRANSPORT', 'Frais de transport')], max_length=15)),
                ('prix', models.DecimalField(decimal_places=2, max_digits=10)),
                ('devise', models.CharField(default='MAD', max_length=5)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('actif', models.BooleanField(default=True)),
                ('date_creation', models.DateTimeField(default=django.utils.timezone.now)),
                ('poisson', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='application.poisson')),
                ('utilisateur_creation', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='application.user')),
            ],
        ),
    ]
